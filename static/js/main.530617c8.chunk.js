(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{107:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},136:function(e,t,a){},137:function(e,t,a){},139:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(17),c=a.n(o),l=(a(76),a(77),a(7)),s=a(144),i=a(141),u=a(143),m=a(5),d=a(19),p=a(63),f=a.n(p),h=Object(d.b)({name:"auth",initialState:{isAuthenticated:!1,user:{},admin:!1},reducers:{setCurrentUser:function(e,t){e.isAuthenticated=!f()(t.payload),e.user=t.payload,e.admin="admin"===t.payload.role},logoutCurrentUser:function(e){e.isAuthenticated=!1,e.user={},localStorage.removeItem("usertoken")}}}),g=h.actions,b=g.setCurrentUser,E=g.logoutCurrentUser,v=function(e){return e.auth.user},j=function(e){return e.auth.isAuthenticated},O=function(e){return e.auth.admin},w=h.reducer,y=Object(d.b)({name:"flashMessage",initialState:{text:"",type:""},reducers:{addFlashMessage:function(e,t){e.text=t.payload.text,e.type=t.payload.type},deleteFlashMessage:function(e){e.text="",e.type=""}}}),N=y.actions,C=N.addFlashMessage,S=N.deleteFlashMessage,k=function(e){return e.flashMessage.text},x=function(e){return e.flashMessage.type},I=y.reducer,z=(a(107),a(11)),P=a.n(z);function F(e){e?P.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete P.a.defaults.headers.common.Authorization}var M=a(30);function B(e){var t=Object(m.c)(j),a=Object(m.c)(O),o=Object(m.b)(),c=Object(r.useState)(0),d=Object(l.a)(c,2),p=d[0],f=d[1];Object(r.useEffect)((function(){f(function(){var e=localStorage.getItem("usertoken");if(e){var t=Object(M.a)(e).exp;if(Date.now()>=1e3*t)return 0;var a=1e3*t-Date.now();return Math.round(a%864e5%36e5/6e4)}}())}),[]);var h=n.a.createElement(s.a.Item,null,n.a.createElement(i.a,{className:"loginButton",href:"#login",variant:"primary",size:"sm"},"Login")," "),g=n.a.createElement(s.a.Item,null,n.a.createElement(i.a,{onClick:function(){o(E()),o(C({text:"Sie wurden erfolgreich ausgeloggt.",type:"success"})),F(!1),window.location.reload()},className:"logoutButton",variant:"primary",size:"sm"},"Logout")," "),b=n.a.createElement(s.a.Item,null,n.a.createElement(i.a,{id:"sessionCounter",variant:"outline-primary",size:"sm"},"Sitzung endet in: ",p," min")," ");return n.a.createElement(u.a,{id:"navbar",bg:"light",expand:"lg"},n.a.createElement(u.a.Brand,{id:"logo",href:"#"},"React"),n.a.createElement(u.a.Toggle,{"aria-controls":"basic-navbar-nav"}),n.a.createElement(u.a.Collapse,{id:"basic-navbar-nav"},n.a.createElement(s.a,{className:"mr-auto"},n.a.createElement(s.a.Item,null,n.a.createElement(s.a.Link,{id:"posts",href:"#posts"},"Spr\xfcche")),!t&&n.a.createElement(s.a.Item,null,n.a.createElement(i.a,{className:"registerButton",href:"#register",variant:"primary",size:"sm"},"Registrieren")," "),t&&n.a.createElement(s.a.Item,null,n.a.createElement(i.a,{href:"#profile",className:"profileButton",variant:"primary",size:"sm"},"Profil")," ")),n.a.createElement(s.a,{className:"ml-auto"},t&&b,a&&n.a.createElement(s.a.Item,null,n.a.createElement(i.a,{id:"adminBtn",size:"sm",variant:"outline-danger"},"Admin"),""),t?g:h)))}a(22);function A(){var e=localStorage.getItem("usertoken"),t=Object(m.c)(j),a="";e&&t&&(a=Object(M.a)(e).firstName);return n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"jumbotron mt-5"},n.a.createElement("div",{className:"col-sm-8 mx-auto"},n.a.createElement("h1",{className:"text-center"},"Willkommen ",a))))}var D=a(142);a(126);function R(e){var t=Object(r.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(r.useState)(""),u=Object(l.a)(s,2),d=u[0],p=u[1],f=Object(r.useState)({}),h=Object(l.a)(f,2),g=h[0],E=h[1],v=Object(m.b)();return n.a.createElement("div",{className:"container",id:"loginContainer"},n.a.createElement("h2",{className:"brand"},"JH Reactive"),n.a.createElement(D.a,{onSubmit:function(t){t.preventDefault(),E({});var a={email:o,password:d};v(b({email:o})),function(e){return P.a.post("https://glacial-fortress-07261.herokuapp.com/users/login",e).then((function(e){return localStorage.setItem("usertoken",e.data),e.data}))}(a).then((function(t){t.errors?(E(t.errors),v(C({text:"Der Login war nicht erfolgreich",type:"error"}))):(v(C({text:"Der Login war erfolgreich",type:"success"})),e.history.push("/"))}))},className:"loginForm",autoComplete:"off"},g.login&&n.a.createElement("div",{className:"alert alert-danger"},g.login),n.a.createElement(D.a.Group,{className:"emailField"},n.a.createElement(D.a.Control,{id:"email",required:!0,type:"email",placeholder:"E-Mail-Adresse",value:o,onChange:function(e){return c(e.target.value)}})),n.a.createElement(D.a.Group,{className:"passwordField"},n.a.createElement(D.a.Control,{id:"password",required:!0,type:"password",placeholder:"Passwort",value:d,onChange:function(e){return p(e.target.value)}})),n.a.createElement(i.a,{type:"submit",className:"button",variant:"primary",size:"sm",block:!0},"Einloggen")))}var q=a(70),G=a(6),H=a(69);a(127);function L(e){var t=Object(r.useState)(""),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(r.useState)(""),u=Object(l.a)(s,2),d=u[0],p=u[1],f=Object(r.useState)(""),h=Object(l.a)(f,2),g=h[0],b=h[1],E=Object(r.useState)(""),v=Object(l.a)(E,2),j=v[0],O=v[1],w=Object(r.useState)(""),y=Object(l.a)(w,2),N=y[0],S=y[1],k=Object(r.useState)({}),x=Object(l.a)(k,2),I=x[0],z=x[1],F=Object(r.useState)(!1),M=Object(l.a)(F,2),B=M[0],A=M[1],R=Object(m.b)();return n.a.createElement("div",{className:"container",id:"registerContainer"},n.a.createElement("h2",{className:"brand"},"JH Reactive"),n.a.createElement(D.a,{onSubmit:function(t){t.preventDefault(),z({}),A(!0),function(e){return P.a.post("https://glacial-fortress-07261.herokuapp.com/users/register",e).then((function(e){return e.data}))}({firstName:o,lastName:d,email:g,password:j,repeatPassword:N}).then((function(t){t.errors?(R(C({text:"Die Registrierung war nicht erfolgreich",type:"error"})),z(t.errors)):(R(C({text:"Die Registrierung war erfolgreich",type:"success"})),e.history.push("/login"))})).catch((function(e){console.error(e)})).finally((function(){A(!1)}))},className:"registerForm",autoComplete:"off"},I.user&&n.a.createElement("div",{className:"alert alert-danger"},I.user),I.repeatPassword&&n.a.createElement("div",{className:"alert alert-danger"},I.repeatPassword),n.a.createElement(D.a.Group,{className:"nameRow"},n.a.createElement(D.a.Row,null,n.a.createElement(H.a,null,n.a.createElement(D.a.Control,{id:"firstName",required:!0,placeholder:"Vorname",value:o,onChange:function(e){return c(e.target.value)}})),n.a.createElement(H.a,null,n.a.createElement(D.a.Control,{id:"lastName",required:!0,placeholder:"Nachname",value:d,onChange:function(e){return p(e.target.value)}})))),n.a.createElement(D.a.Group,{className:"emailField"},n.a.createElement(D.a.Control,{id:"email",required:!0,type:"email",placeholder:"E-Mail-Adresse",value:g,onChange:function(e){return b(e.target.value)}})),n.a.createElement(D.a.Group,{className:"passwordField"},n.a.createElement(D.a.Control,{id:"password",required:!0,type:"password",placeholder:"Passwort",value:j,onChange:function(e){return O(e.target.value)}})),n.a.createElement(D.a.Group,{className:"passwordField"},n.a.createElement(D.a.Control,{id:"repeatPassword",required:!0,type:"password",placeholder:"Passwort wiederholen",value:N,onChange:function(e){return S(e.target.value)}})),n.a.createElement(i.a,{disabled:B,type:"submit",className:"button",variant:"primary",size:"sm",block:!0},"Registrieren")))}function J(e){var t=Object(m.c)(v),a=Object(r.useState)(""),o=Object(l.a)(a,2),c=(o[0],o[1]);return Object(r.useEffect)((function(){localStorage.getItem("usertoken")||e.history.push("/login")})),n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"jumbotron mt-5"},n.a.createElement("div",{className:"col-sm-8 mx-auto"},n.a.createElement("h1",{className:"text-center"},"PROFIL"),n.a.createElement("p",null,"Vorname: ",t.firstName),n.a.createElement("p",null,"Nachname: ",t.lastName),n.a.createElement("p",null,"Email: ",t.email),n.a.createElement("p",null,"id: ",t._id),n.a.createElement(D.a,{onSubmit:function(){var e={email:e.email,notification:"on"!==c};!function(e){P.a.patch("https://glacial-fortress-07261.herokuapp.com/users/update",e).then((function(e){return e.data})).catch((function(e){console.warn(e)}))}(e)}},n.a.createElement(D.a.Group,{controlId:"formBasicCheckbox"},n.a.createElement(D.a.Check,{onChange:function(e){return c(e.target.value)},type:"checkbox",label:"Ich will keine Mitteilungen erhalten"})),n.a.createElement(i.a,{size:"sm",variant:"primary",type:"submit"},"Speichern")))))}var U=a(32),W=a.n(U);a(136);function T(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),a=t[0],o=t[1],c=Object(r.useState)(""),s=Object(l.a)(c,2),u=s[0],d=s[1],p=Object(r.useState)([]),f=Object(l.a)(p,2),h=f[0],g=f[1],b=Object(r.useState)(!1),E=Object(l.a)(b,2),w=E[0],y=E[1],N=Object(m.c)(j),C=Object(m.c)(v),S=Object(m.c)(O),k=C.firstName+" "+C.lastName;Object(r.useEffect)((function(){P.a.get("https://glacial-fortress-07261.herokuapp.com/posts/fetch").then((function(e){return e.data})).catch((function(e){console.warn(e)})).then((function(e){return g(e.reverse())}))}),[]);var x=n.a.createElement(D.a,{id:"postForm",onSubmit:function(e){var t;e.preventDefault(),y(!0),function(e){return P.a.post("https://glacial-fortress-07261.herokuapp.com/posts/submit",e).then((function(e){return e.data})).catch((function(e){console.warn(e)}))}({postHeader:a,postContent:u,creatorName:k,postId:W.a.generate()}).finally((function(){y(!1),window.location.reload()})),t=C.email,P.a.post("https://glacial-fortress-07261.herokuapp.com/emails/sendemail",t).then((function(e){return e.data})).catch((function(e){console.warn(e)}))},autoComplete:"off"},n.a.createElement(D.a.Group,null,n.a.createElement(D.a.Control,{id:"postHeader",required:!0,placeholder:"Spruch-\xdcberschrift",onChange:function(e){return o(e.target.value)},value:a})),n.a.createElement(D.a.Group,null,n.a.createElement("textarea",{id:"postContent",required:!0,className:"form-control","aria-label":"With textarea",placeholder:"Inhalt",onChange:function(e){return d(e.target.value)},value:u})),n.a.createElement(i.a,{disabled:w,type:"submit",id:"submitBtn",size:"sm"},"Spruch ver\xf6ffentlichen"));return n.a.createElement("div",{id:"container"},N&&x,h.length&&n.a.createElement("ul",null,h.map((function(e){return n.a.createElement("div",{id:"postContainer"},S&&n.a.createElement(i.a,{onClick:function(e){return(t=e.target.name,console.log(t),P.a.delete("https://glacial-fortress-07261.herokuapp.com/posts/delete/"+t).then((function(e){return e.data})).catch((function(e){console.warn(e)}))).then((function(){return window.location.reload()}));var t},type:"submit",id:"removePostBtn",name:e._id,variant:"danger",size:"sm"},"Spruch l\xf6schen"),n.a.createElement("div",{id:"headerCard",class:"card-body"},e.postHeader+" (ver\xf6ffentlicht von "+e.creatorName+")"),n.a.createElement("div",{class:"card-body"},e.postContent),n.a.createElement("div",{class:"card-body"},"ver\xf6ffentlicht: "+e.created.split("T")[0]))}))))}var V=a(3),_=a.n(V);a(137);function $(){var e=Object(m.c)(k),t=Object(m.c)(x),a=Object(m.b)();return n.a.createElement("div",{id:"message",className:_()("alert",{"alert-success":"success"===t,"alert-danger":"error"===t})},e&&n.a.createElement("button",{onClick:function(){a(S())},className:"close"},n.a.createElement("span",null,"\xd7")),e)}var K=function(){var e=Object(m.b)(),t=Object(m.c)(v);return Object(r.useEffect)((function(){localStorage.getItem("usertoken")&&(F(localStorage.getItem("usertoken")),t.firstName?P.a.get("https://glacial-fortress-07261.herokuapp.com/users/validateToken").then((function(e){return e.data})).catch((function(e){console.warn(e)})).then((function(t){t.errors&&(localStorage.removeItem("usertoken"),e(C({text:t.errors.tokenExpired,type:"error"})))})):P.a.get("https://glacial-fortress-07261.herokuapp.com/users/profile").then((function(e){return e.data})).catch((function(e){console.warn(e)})).then((function(t){t.errors?(localStorage.removeItem("usertoken"),e(C({text:t.errors.tokenExpired,type:"error"}))):e(b(t))})))}),[]),n.a.createElement(q.a,null,n.a.createElement("div",{className:"App"},n.a.createElement(B,null),n.a.createElement($,null),n.a.createElement(G.a,{exact:!0,path:"/",component:A}),n.a.createElement(G.a,{path:"/register",component:L}),n.a.createElement(G.a,{path:"/login",component:R}),n.a.createElement(G.a,{path:"/profile",component:J}),n.a.createElement(G.a,{path:"/posts",component:T})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Q=Object(d.b)({name:"post",initialState:{posts:[]},reducers:{addPost:function(e,t){var a={postHeader:t.payload.header,postContent:t.payload.text,postCreator:t.payload.creator,created:Date.now(),postId:W.a.generate()};e.posts.push(a)},removePost:function(e,t){var a=e.posts.indexOf((function(e){return e.postId===t.payload.postId}));e.posts.splice(a,1)}}}),X=Q.actions,Y=(X.addPost,X.removePost,Q.reducer),Z=Object(d.a)({reducer:{auth:w,flashMessage:I,post:Y}});c.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(m.a,{store:Z},n.a.createElement(K,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},71:function(e,t,a){e.exports=a(139)},76:function(e,t,a){},77:function(e,t,a){}},[[71,1,2]]]);
//# sourceMappingURL=main.530617c8.chunk.js.map